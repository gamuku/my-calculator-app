<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Work Duration Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    textarea { 
      width: 100%; 
      min-height: 150px; 
      resize: vertical; 
      font-size: 1rem; 
      padding: 0.5rem;
      line-height: 1.4;
      box-sizing: border-box;
    }
    .result { margin-top: 1rem; font-size: 1.2rem; font-weight: bold; }
    button { margin-top: 0.5rem; padding: 0.5rem 1rem; cursor: pointer; }
    .tabs { margin-top: 1.5rem; }
    .tab-buttons button {
      padding: 0.5rem 1rem;
      margin-right: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px 4px 0 0;
      background: #f0f0f0;
      cursor: pointer;
    }
    .tab-buttons button.active {
      background: #fff;
      border-bottom: 1px solid #fff;
      font-weight: bold;
    }
    .tab-content {
      border: 1px solid #ccc;
      border-radius: 0 6px 6px 6px;
      padding: 1rem;
      background: #fff;
      margin-top: -1px;
    }
    .hidden { display: none; }
    .pass { color: green; font-weight: bold; }
    .fail { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Work Duration Calculator ⏱️</h1>

  <div class="tabs">
    <!-- Tab buttons -->
    <div class="tab-buttons">
      <button id="calcTabBtn" class="active" onclick="showTab('calculator')">Calculator</button>
      <button id="testTabBtn" onclick="showTab('tests')">Tests</button>
    </div>

    <!-- Calculator Tab -->
    <div id="calculator" class="tab-content">
      <p>Enter time intervals or durations (e.g. <code>10:00 - 11:30</code> or <code>1:30</code>):</p>
      <textarea id="inputArea" placeholder="Examples:
10:00 - 11:30
12:00 - 14:50
16:00 - 22:00
1:30
90"></textarea>
      <div class="result">Total: <span id="output">00:00:00</span></div>
      <button onclick="copyResult()">Copy</button>
      <button onclick="clearInput()">Clear</button>
    </div>

    <!-- Tests Tab -->
    <div id="tests" class="tab-content hidden">
      <h2>✅ Test Results</h2>
      <button onclick="runTests()">Run Tests</button>
      <div id="testResults"></div>
    </div>
  </div>

  <script>
    function parseTime(str) {
      const parts = str.split(":").map(p => parseInt(p, 10));
      if (parts.length === 2) {
        return parts[0] * 3600 + parts[1] * 60;
      } else if (parts.length === 3) {
        return parts[0] * 3600 + parts[1] * 60 + parts[2];
      } else if (!isNaN(str)) {
        return parseInt(str, 10) * 60;
      }
      return 0;
    }

    function formatDuration(seconds) {
      const h = Math.floor(seconds / 3600);
      const m = Math.floor((seconds % 3600) / 60);
      const s = seconds % 60;
      return `${String(h).padStart(2, "0")}:${String(m).padStart(2, "0")}:${String(s).padStart(2, "0")}`;
    }

    function calculate() {
      const lines = document.getElementById("inputArea").value.split("\n");
      let totalSeconds = 0;

      lines.forEach(line => {
        const trimmed = line.trim();
        if (!trimmed) return;

        if (trimmed.includes("-")) {
          const [start, end] = trimmed.split("-").map(t => t.trim());
          const startSec = parseTime(start);
          const endSec = parseTime(end);
          if (endSec > startSec) {
            totalSeconds += (endSec - startSec);
          }
        } else {
          totalSeconds += parseTime(trimmed);
        }
      });

      document.getElementById("output").innerText = formatDuration(totalSeconds);
    }

    function copyResult() {
      const text = document.getElementById("output").innerText;
      navigator.clipboard.writeText(text);
      alert("Copied: " + text);
    }

    function clearInput() {
      document.getElementById("inputArea").value = "";
      document.getElementById("output").innerText = "00:00:00";
    }

    // Auto-resize textarea
    function autoResize(el) {
      el.style.height = "auto";
      el.style.height = (el.scrollHeight) + "px";
    }

    document.getElementById("inputArea").addEventListener("input", function() {
      calculate();
      autoResize(this);
    });

    // Tests
    function runTests() {
      const tests = [
        { input: ["10:00 - 11:30"], expected: "01:30:00" },
        { input: ["10:00 - 11:30", "12:00 - 14:50", "16:00 - 22:00"], expected: "10:20:00" },
        { input: ["1:30"], expected: "01:30:00" },
        { input: ["90"], expected: "01:30:00" },
        { input: ["0:45:20"], expected: "00:45:20" },
        { input: ["3600"], expected: "60:00:00" }
      ];

      let output = "";
      tests.forEach((test, i) => {
        let totalSeconds = 0;
        test.input.forEach(line => {
          if (line.includes("-")) {
            const [start, end] = line.split("-").map(t => t.trim());
            totalSeconds += parseTime(end) - parseTime(start);
          } else {
            totalSeconds += parseTime(line);
          }
        });
        const result = formatDuration(totalSeconds);
        const pass = result === test.expected;
        output += `<div class="${pass ? 'pass' : 'fail'}">Test ${i + 1}: ${pass ? "✅ PASS" : "❌ FAIL"}<br>
        Input: ${test.input.join(", ")}<br>
        Expected: ${test.expected}<br>
        Got: ${result}</div><br>`;
      });

      document.getElementById("testResults").innerHTML = output;
    }

    // Tab switching
    function showTab(tab) {
      document.getElementById("calculator").classList.add("hidden");
      document.getElementById("tests").classList.add("hidden");
      document.getElementById(tab).classList.remove("hidden");

      document.getElementById("calcTabBtn").classList.remove("active");
      document.getElementById("testTabBtn").classList.remove("active");
      if (tab === "calculator") {
        document.getElementById("calcTabBtn").classList.add("active");
      } else {
        document.getElementById("testTabBtn").classList.add("active");
      }
    }
  </script>
</body>
</html>
